<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ—Ç—Ä–æ New - –ú–æ—Å–∫–æ–≤—Å–∫–∏–π –º–µ—Ç—Ä–æ–ø–æ–ª–∏—Ç–µ–Ω –≤ Roblox</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-check.js"></script>
    
    <style>
        :root {
            --primary: #0066CC;
            --primary-dark: #0052a3;
            --primary-light: #4d94ff;
            --secondary: #FFD700;
            --secondary-dark: #e6c200;
            --dark: #1A1A1A;
            --light: #F8F9FA;
            --gray: #6C757D;
            --gray-light: #e9ecef;
            --success: #28A745;
            --warning: #FFC107;
            --danger: #DC3545;
            --shadow-md: 0 4px 12px rgba(0,0,0,0.15);
            --shadow-lg: 0 8px 25px rgba(0,0,0,0.2);
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 15px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: var(--light);
            color: var(--dark);
        }
        
        main {
            flex: 1;
        }
    </style>
</head>
<body>
    <!-- –•–ï–î–ï–† -->
    <header class="main-header">
        <div class="header-container">
            <div class="header-left">
                <a href="/" class="logo">
                    <span class="logo-icon">M</span>
                    <span>–ú–µ—Ç—Ä–æ New</span>
                </a>
            </div>
            
            <div class="header-center">
                <nav class="breadcrumbs">
                    <div class="breadcrumb-item">
                        <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
                        <span class="breadcrumb-separator">‚Ä∫</span>
                    </div>
                    <div class="breadcrumb-item">
                        <a href="/games">–ò–≥—Ä—ã</a>
                        <span class="breadcrumb-separator">‚Ä∫</span>
                    </div>
                    <div class="breadcrumb-item">
                        <span class="breadcrumb-current">–ú–µ—Ç—Ä–æ New</span>
                    </div>
                </nav>
            </div>
            
            <div class="header-right">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫..." disabled>
                </div>
                
                <div class="dropdown user-profile" id="userDropdown">
                    <div class="user-avatar" id="userAvatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="user-info">
                        <div class="user-name" id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        <div class="user-status" id="userStatus">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                    
                    <div class="dropdown-menu" id="userMenu">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è —á–µ—Ä–µ–∑ Firebase -->
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
    <main class="container">
        <section class="hero">
            <h1>–ú–µ—Ç—Ä–æ New - –ú–æ—Å–∫–æ–≤—Å–∫–∏–π –º–µ—Ç—Ä–æ–ø–æ–ª–∏—Ç–µ–Ω –≤ Roblox</h1>
            <p>–ü–æ–≥—Ä—É–∑–∏—Ç–µ—Å—å –≤ —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –º–æ—Å–∫–æ–≤—Å–∫–æ–≥–æ –º–µ—Ç—Ä–æ, –≤–æ—Å—Å–æ–∑–¥–∞–Ω–Ω—É—é —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –≤ Roblox. –ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Å—Ç–∞–Ω—Ü–∏–∏, —É–ø—Ä–∞–≤–ª—è–π—Ç–µ –ø–æ–µ–∑–¥–∞–º–∏ –∏ —Å—Ç–∞–Ω–æ–≤–∏—Å—å —á–∞—Å—Ç—å—é –Ω–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞!</p>
            <div class="hero-buttons">
                <a href="https://www.roblox.com/communities/34820737/RP-NEW" class="btn btn-primary" target="_blank">
                    <i class="fas fa-play"></i>
                    –ò–≥—Ä–∞—Ç—å —Å–µ–π—á–∞—Å
                </a>
                <a href="#" class="btn btn-outline" id="aboutBtn">
                    <i class="fas fa-info-circle"></i>
                    –£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ
                </a>
            </div>
        </section>
        
        <div class="content-grid">
            <div class="content-card">
                <h3><i class="fas fa-gamepad"></i> –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏–≥—Ä—ã</h3>
                <ul class="feature-list">
                    <li><i class="fas fa-subway"></i> –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ø–æ–µ–∑–¥–∞ –º–æ—Å–∫–æ–≤—Å–∫–æ–≥–æ –º–µ—Ç—Ä–æ</li>
                    <li><i class="fas fa-map-marked-alt"></i> –¢–æ—á–Ω—ã–µ –∫–æ–ø–∏–∏ —Å—Ç–∞–Ω—Ü–∏–π</li>
                    <li><i class="fas fa-users"></i> –ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º</li>
                    <li><i class="fas fa-train"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–µ–∑–¥–∞–º–∏</li>
                </ul>
            </div>
            
            <div class="content-card">
                <h3><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number">15K+</div>
                        <div class="stat-label">–ò–≥—Ä–æ–∫–æ–≤</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">247</div>
                        <div class="stat-label">–û–Ω–ª–∞–π–Ω —Å–µ–π—á–∞—Å</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">1.2M+</div>
                        <div class="stat-label">–ö–º –ø—Ä–æ–π–¥–µ–Ω–æ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">3</div>
                        <div class="stat-label">–õ–∏–Ω–∏–∏ –º–µ—Ç—Ä–æ</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="content-card metro-lines">
            <h2><i class="fas fa-subway"></i> –õ–∏–Ω–∏–∏ –º–µ—Ç—Ä–æ –≤ –∏–≥—Ä–µ</h2>
            <div class="lines-grid">
                <div class="line-card">
                    <div class="line-color" style="background-color: #FF0000;"></div>
                    <div class="line-name">–°–æ–∫–æ–ª—å–Ω–∏—á–µ—Å–∫–∞—è</div>
                    <div class="line-stations">3 —Å—Ç–∞–Ω—Ü–∏–∏</div>
                </div>
                <div class="line-card">
                    <div class="line-color" style="background-color: #008000;"></div>
                    <div class="line-name">–ó–∞–º–æ—Å–∫–≤–æ—Ä–µ—Ü–∫–∞—è</div>
                    <div class="line-stations">–°–∫–æ—Ä–æ</div>
                </div>
                <div class="line-card">
                    <div class="line-color" style="background-color: #0000FF;"></div>
                    <div class="line-name">–ê—Ä–±–∞—Ç—Å–∫–æ-–ü–æ–∫—Ä–æ–≤—Å–∫–∞—è</div>
                    <div class="line-stations">–°–∫–æ—Ä–æ</div>
                </div>
            </div>
        </div>
    </main>

    <!-- –§–£–¢–ï–† -->
    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-grid">
                <div class="footer-column">
                    <h4><i class="fas fa-info-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                    <ul>
                        <li><a href="#">–û –ø—Ä–æ–µ–∫—Ç–µ</a></li>
                        <li><a href="#">–ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞</a></li>
                        <li><a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                        <li><a href="#">–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h4><i class="fas fa-file-contract"></i> –î–æ–∫—É–º–µ–Ω—Ç—ã</h4>
                    <ul>
                        <li><a href="#">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></li>
                        <li><a href="#">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</a></li>
                        <li><a href="#">–ü—Ä–∞–≤–∏–ª–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</a></li>
                        <li><a href="#">–ü–æ–ª–∏—Ç–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h4><i class="fas fa-headset"></i> –ü–æ–¥–¥–µ—Ä–∂–∫–∞</h4>
                    <ul>
                        <li><a href="#">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</a></li>
                        <li><a href="#">–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤</a></li>
                        <li><a href="#">–°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ</a></li>
                        <li><a href="#">–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–¥–µ—é</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h4><i class="fas fa-share-alt"></i> –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h4>
                    <div class="social-links">
                        <a href="https://discord.com/invite/WjGZBs3HMX" class="social-link" target="_blank">
                            <i class="fab fa-discord"></i>
                            <span>Discord</span>
                        </a>
                        <a href="https://t.me/metronewroblox" class="social-link" target="_blank">
                            <i class="fab fa-telegram"></i>
                            <span>Telegram</span>
                        </a>
                        <a href="https://www.youtube.com/@Metro-RP-NEW-Roblox" class="social-link" target="_blank">
                            <i class="fab fa-youtube"></i>
                            <span>YouTube</span>
                        </a>
                        <a href="https://www.roblox.com/communities/34820737/RP-NEW" class="social-link" target="_blank">
                            <i class="fab fa-roblox"></i>
                            <span>Roblox</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="copyright">
                    <p>&copy; <span id="currentYear"></span> –ú–µ—Ç—Ä–æ New. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ê–ö–ö–ê–£–ù–¢–ê -->
    <div class="modal" id="accountModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-circle"></i> –ú–æ–π –∞–∫–∫–∞—É–Ω—Ç</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="account-header">
                    <div class="account-avatar" id="accountAvatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="account-info">
                        <h4 id="accountName">–ó–∞–≥—Ä—É–∑–∫–∞...</h4>
                        <p id="accountEmail">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        <span class="account-badge" id="accountBadge">–ì–æ—Å—Ç—å</span>
                    </div>
                </div>
                
                <div class="account-tabs">
                    <button class="account-tab active" data-tab="profile">
                        <i class="fas fa-user"></i>
                        <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
                    </button>
                    <button class="account-tab" data-tab="settings">
                        <i class="fas fa-cog"></i>
                        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                    </button>
                    <button class="account-tab" data-tab="notifications">
                        <i class="fas fa-bell"></i>
                        <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                        <span class="tab-badge" id="notifBadge">0</span>
                    </button>
                </div>
                
                <div class="account-tab-content active" id="profileTab">
                    <div class="account-section">
                        <h5><i class="fas fa-sign-in-alt"></i> –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h5>
                        <div class="auth-buttons">
                            <button class="btn btn-primary" id="loginBtn">
                                <i class="fas fa-sign-in-alt"></i>
                                –í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç
                            </button>
                            <button class="btn btn-outline" id="registerBtn">
                                <i class="fas fa-user-plus"></i>
                                –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                            </button>
                        </div>
                        <p class="account-note" id="authNote"></p>
                    </div>
                    
                    <div class="account-section">
                        <h5><i class="fas fa-user"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è</h5>
                        <div class="profile-info">
                            <div class="info-item">
                                <span class="info-label">–°—Ç–∞—Ç—É—Å:</span>
                                <span class="info-value" id="profileStatus">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</span>
                                <span class="info-value" id="profileRegDate">‚Äî</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥:</span>
                                <span class="info-value" id="profileLastLogin">‚Äî</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">UID:</span>
                                <span class="info-value" id="profileUID">‚Äî</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="account-section" id="profileActionsSection" style="display: none;">
                        <h5><i class="fas fa-user-edit"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º</h5>
                        <div class="profile-actions">
                            <button class="btn btn-small" id="changeAvatarBtn">
                                <i class="fas fa-camera"></i>
                                –°–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                            </button>
                            <button class="btn btn-small btn-outline" id="changePasswordBtn">
                                <i class="fas fa-key"></i>
                                –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="account-tab-content" id="settingsTab">
                    <div class="account-section">
                        <h5><i class="fas fa-palette"></i> –í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h5>
                        <div class="setting-item">
                            <div class="setting-info">
                                <span class="setting-label">–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</span>
                                <span class="setting-desc">–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–µ—Ç–ª—É—é –∏–ª–∏ —Ç—ë–º–Ω—É—é —Ç–µ–º—É</span>
                            </div>
                            <div class="setting-control">
                                <div class="theme-toggle" id="themeToggle">
                                    <button class="theme-option active" data-theme="light">
                                        <i class="fas fa-sun"></i>
                                        <span>–°–≤–µ—Ç–ª–∞—è</span>
                                    </button>
                                    <button class="theme-option" data-theme="dark">
                                        <i class="fas fa-moon"></i>
                                        <span>–¢—ë–º–Ω–∞—è</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <span class="setting-label">–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</span>
                                <span class="setting-desc">–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ —Å–∞–π—Ç–∞</span>
                            </div>
                            <div class="setting-control">
                                <div class="lang-selector" id="langSelector">
                                    <button class="lang-option active" data-lang="ru">
                                        <span class="lang-flag ru"></span>
                                        <span>–†—É—Å—Å–∫–∏–π</span>
                                    </button>
                                    <button class="lang-option" data-lang="en">
                                        <span class="lang-flag en"></span>
                                        <span>English</span>
                                    </button>
                                    <button class="lang-option" data-lang="es">
                                        <span class="flag-icon">üá™üá∏</span>
                                        <span>Espa√±ol</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="account-section">
                        <h5><i class="fas fa-envelope"></i> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –ø–æ—á—Ç–∞</h5>
                        <div class="setting-item">
                            <div class="setting-info">
                                <span class="setting-label">Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                                <span class="setting-desc">–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ –ø–æ—á—Ç—É</span>
                            </div>
                            <div class="setting-control">
                                <label class="switch">
                                    <input type="checkbox" id="emailNotifications" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <span class="setting-label">–ù–æ–≤–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞</span>
                                <span class="setting-desc">–ü–æ–ª—É—á–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö</span>
                            </div>
                            <div class="setting-control">
                                <label class="switch">
                                    <input type="checkbox" id="projectNews" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="account-tab-content" id="notificationsTab">
                    <div class="account-section">
                        <h5><i class="fas fa-bell"></i> –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h5>
                        <div class="notifications-list" id="notificationsList">
                            <div class="notification-empty">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>–ó–∞–≥—Ä—É–∑–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...</p>
                            </div>
                        </div>
                        
                        <div class="notifications-actions" id="notificationsActions" style="display: none;">
                            <button class="btn btn-small" id="markAllReadBtn">
                                <i class="fas fa-check-double"></i>
                                –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å—ë –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
                            </button>
                            <button class="btn btn-small btn-outline" id="clearNotificationsBtn">
                                <i class="fas fa-trash"></i>
                                –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-sign-in-alt"></i> –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="auth-tabs">
                    <button class="auth-tab active" data-tab="login">–í—Ö–æ–¥</button>
                    <button class="auth-tab" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                
                <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
                <form id="loginForm" class="auth-form active">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="loginEmail" placeholder="example@mail.ru" required>
                    </div>
                    <div class="form-group">
                        <label>–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        <div class="password-requirements">
                            <small>–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤: –∑–∞–≥–ª–∞–≤–Ω—ã–µ, —Å—Ç—Ä–æ—á–Ω—ã–µ, —Ü–∏—Ñ—Ä—ã, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã</small>
                        </div>
                    </div>
                    <div class="form-options">
                        <label class="checkbox">
                            <input type="checkbox" id="rememberMe" checked>
                            <span>–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è</span>
                        </label>
                        <a href="#" class="forgot-password" id="forgotPasswordBtn">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
                    </div>
                    <button type="submit" class="btn btn-primary" id="loginSubmitBtn">
                        <i class="fas fa-sign-in-alt"></i>
                        –í–æ–π—Ç–∏
                    </button>
                    <div class="auth-error" id="loginError" style="display: none;"></div>
                </form>
                
                <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
                <form id="registerForm" class="auth-form">
                    <div class="form-group">
                        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                        <input type="text" id="registerUsername" placeholder="MetroDriver" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="registerEmail" placeholder="example@mail.ru" required>
                    </div>
                    <div class="form-group">
                        <label>–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="registerPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        <div class="password-strength" id="passwordStrength">
                            <div class="strength-bar"></div>
                            <div class="strength-text">–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª—è: <span id="strengthText">—Å–ª–∞–±—ã–π</span></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="registerConfirmPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        <div class="password-match" id="passwordMatch" style="display: none;">
                            <small style="color: var(--success);">‚úì –ü–∞—Ä–æ–ª–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç</small>
                        </div>
                    </div>
                    <div class="form-options">
                        <label class="checkbox">
                            <input type="checkbox" id="agreeTerms" required>
                            <span>–Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å <a href="#" style="color: var(--primary);">–ø—Ä–∞–≤–∏–ª–∞–º–∏</a> –∏ <a href="#" style="color: var(--primary);">–ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></span>
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary" id="registerSubmitBtn">
                        <i class="fas fa-user-plus"></i>
                        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                    <div class="auth-error" id="registerError" style="display: none;"></div>
                </form>
                
                <div class="auth-divider">
                    <span>–∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑</span>
                </div>
                
                <div class="social-auth">
                    <button class="btn-social google" id="googleLoginBtn">
                        <i class="fab fa-google"></i>
                        Google
                    </button>
                    <button class="btn-social anonymous" id="anonymousLoginBtn">
                        <i class="fas fa-user-secret"></i>
                        –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫–∞–∫ –≥–æ—Å—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø –ü–ê–†–û–õ–Ø -->
    <div class="modal" id="passwordResetModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-key"></i> –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email</label>
                    <input type="email" id="resetEmail" placeholder="example@mail.ru" required>
                    <small>–ù–∞ —ç—Ç–æ—Ç email –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è</small>
                </div>
                <button class="btn btn-primary" id="sendResetBtn">
                    <i class="fas fa-paper-plane"></i>
                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É
                </button>
                <div class="reset-message" id="resetMessage" style="display: none; margin-top: 1rem; padding: 1rem; background: var(--light); border-radius: var(--radius-md);"></div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –°–ú–ï–ù–´ –ü–ê–†–û–õ–Ø -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-key"></i> –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="currentPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å" required>
                </div>
                <div class="form-group">
                    <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="newPassword" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" required>
                    <div class="password-strength">
                        <div class="strength-bar"></div>
                        <div class="strength-text">–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª—è: <span>—Å–ª–∞–±—ã–π</span></div>
                    </div>
                </div>
                <div class="form-group">
                    <label>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="confirmNewPassword" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>
                <button class="btn btn-primary" id="changePasswordSubmitBtn">
                    <i class="fas fa-save"></i>
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å
                </button>
                <div class="password-change-message" id="passwordChangeMessage" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ó–ê–ì–†–£–ó–ö–ò –ê–í–ê–¢–ê–†–ê -->
    <div class="modal" id="avatarModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-camera"></i> –°–º–µ–Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="avatar-upload">
                    <div class="avatar-preview" id="avatarPreview">
                        <img src="" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä" id="avatarPreviewImg" style="display: none;">
                        <i class="fas fa-user" id="avatarPreviewIcon"></i>
                    </div>
                    <input type="file" id="avatarFileInput" accept="image/*" style="display: none;">
                    <button class="btn btn-outline" id="chooseAvatarBtn">
                        <i class="fas fa-folder-open"></i>
                        –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
                    </button>
                    <small style="display: block; margin-top: 0.5rem; color: var(--gray);">
                        –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 2MB. –§–æ—Ä–º–∞—Ç—ã: JPG, PNG, GIF
                    </small>
                </div>
                <div class="avatar-actions" style="margin-top: 2rem;">
                    <button class="btn btn-primary" id="uploadAvatarBtn" disabled>
                        <i class="fas fa-upload"></i>
                        –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                    </button>
                    <button class="btn btn-outline" id="removeAvatarBtn" style="display: none;">
                        <i class="fas fa-trash"></i>
                        –£–¥–∞–ª–∏—Ç—å –∞–≤–∞—Ç–∞—Ä
                    </button>
                </div>
                <div class="avatar-message" id="avatarMessage" style="display: none; margin-top: 1rem;"></div>
            </div>
        </div>
    </div>

    <style>
        /* –°–¢–ò–õ–ò –û–°–¢–ê–Æ–¢–°–Ø –¢–ê–ö–ò–ú–ò –ñ–ï, –ö–ê–ö –í –ü–†–ï–î–´–î–£–©–ï–ô –í–ï–†–°–ò–ò */
        /* –•–ï–î–ï–†, –ö–û–ù–¢–ï–ù–¢, –§–£–¢–ï–†, –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê */
        .main-header {
            background-color: white;
            border-bottom: 1px solid var(--gray-light);
            padding: 0.75rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-md);
        }
        
        .header-container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1.5rem;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            min-width: 200px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            text-decoration: none;
            color: var(--dark);
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.3rem;
        }
        
        .header-center {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .breadcrumbs {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
            color: var(--gray);
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .breadcrumb-item a {
            color: var(--dark);
            text-decoration: none;
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-md);
            transition: all 0.3s;
        }
        
        .breadcrumb-item a:hover {
            background-color: var(--gray-light);
        }
        
        .breadcrumb-current {
            color: var(--primary);
            font-weight: 600;
            padding: 0.25rem 0.5rem;
            background-color: rgba(0, 102, 204, 0.1);
            border-radius: var(--radius-md);
        }
        
        .breadcrumb-separator {
            color: var(--gray);
            font-size: 0.8rem;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
            min-width: 300px;
            justify-content: flex-end;
        }
        
        .search-container {
            position: relative;
            width: 200px;
        }
        
        .search-input {
            width: 100%;
            padding: 0.6rem 1rem 0.6rem 2.5rem;
            background-color: var(--gray-light);
            border: 1px solid transparent;
            border-radius: 50px;
            font-size: 0.9rem;
            color: var(--dark);
            transition: all 0.3s;
        }
        
        .search-input:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            background-color: white;
            width: 250px;
        }
        
        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.25rem 0.5rem 0.25rem 0.25rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 160px;
        }
        
        .user-profile:hover {
            background-color: var(--gray-light);
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6c757d, #495057);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            overflow: hidden;
        }
        
        .user-avatar i {
            font-size: 1.8rem;
        }
        
        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
            gap: 0.1rem;
            flex: 1;
        }
        
        .user-name {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--dark);
        }
        
        .user-status {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        .dropdown {
            position: relative;
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background-color: white;
            border: 1px solid var(--gray-light);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            min-width: 250px;
            padding: 0.5rem;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s;
            z-index: 1001;
        }
        
        .dropdown.show .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--dark);
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 0.9rem;
        }
        
        .dropdown-item:hover {
            background-color: var(--gray-light);
        }
        
        .dropdown-item.logout {
            color: var(--danger);
        }
        
        .dropdown-item.logout:hover {
            background-color: rgba(220, 53, 69, 0.1);
        }
        
        /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ */
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 15px;
        }
        
        .hero {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark)), 
                        url('https://images.unsplash.com/photo-1542553458-79a13aebfda6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80') center/cover no-repeat;
            border-radius: var(--radius-xl);
            padding: 4rem 2rem;
            color: white;
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .hero p {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto 2rem;
            opacity: 0.9;
        }
        
        .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-lg);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            color: var(--dark);
            box-shadow: var(--shadow-md);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }
        
        .btn-outline:hover {
            background: var(--secondary);
            color: var(--dark);
        }
        
        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }
        
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .content-card {
            background-color: white;
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-md);
            transition: transform 0.3s;
        }
        
        .content-card:hover {
            transform: translateY(-5px);
        }
        
        .content-card h3 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .feature-list {
            list-style: none;
            padding-left: 0;
        }
        
        .feature-list li {
            margin-bottom: 1rem;
            padding-left: 2rem;
            position: relative;
        }
        
        .feature-list li i {
            position: absolute;
            left: 0;
            top: 0.2rem;
            color: var(--primary);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }
        
        .stat-item {
            text-align: center;
            padding: 1rem;
            background: var(--gray-light);
            border-radius: var(--radius-lg);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .metro-lines h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .lines-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .line-card {
            text-align: center;
            padding: 1.5rem;
            background: var(--gray-light);
            border-radius: var(--radius-lg);
            transition: all 0.3s;
        }
        
        .line-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }
        
        .line-color {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            margin-bottom: 1rem;
        }
        
        .line-name {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }
        
        .line-stations {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        /* –§–£–¢–ï–† */
        .main-footer {
            background-color: var(--dark);
            color: white;
            padding: 3rem 0 2rem;
            margin-top: 3rem;
        }
        
        .footer-container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .footer-column h4 {
            color: var(--secondary);
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .footer-column ul {
            list-style: none;
            padding-left: 0;
        }
        
        .footer-column li {
            margin-bottom: 0.75rem;
        }
        
        .footer-column a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .footer-column a:hover {
            color: var(--secondary);
        }
        
        .social-links {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }
        
        .social-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s;
            padding: 0.5rem;
            border-radius: var(--radius-md);
        }
        
        .social-link:hover {
            color: var(--secondary);
            background-color: rgba(255, 215, 0, 0.1);
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .copyright {
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        
        .modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--radius-xl);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .modal-header h3 {
            color: var(--dark);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 2rem;
            color: var(--gray);
            cursor: pointer;
            line-height: 1;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-close:hover {
            color: var(--dark);
        }
        
        .modal-body {
            padding: 2rem;
        }
        
        /* –û–ö–ù–û –ê–ö–ö–ê–£–ù–¢–ê */
        .account-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .account-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6c757d, #495057);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            overflow: hidden;
        }
        
        .account-avatar i {
            font-size: 3.5rem;
        }
        
        .account-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .account-info h4 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }
        
        .account-info p {
            color: var(--gray);
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
        }
        
        .account-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background-color: var(--primary);
            color: white;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .account-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .account-tab {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--gray);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .account-tab i {
            font-size: 1.2rem;
        }
        
        .account-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .tab-badge {
            background-color: var(--danger);
            color: white;
            font-size: 0.7rem;
            padding: 0.1rem 0.4rem;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }
        
        .account-tab-content {
            display: none;
        }
        
        .account-tab-content.active {
            display: block;
        }
        
        .account-section {
            margin-bottom: 2rem;
        }
        
        .account-section h5 {
            color: var(--dark);
            margin-bottom: 1rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .auth-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .account-note {
            color: var(--gray);
            font-size: 0.9rem;
            font-style: italic;
        }
        
        .profile-info {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .info-label {
            color: var(--gray);
            font-weight: 500;
        }
        
        .info-value {
            color: var(--dark);
            font-weight: 600;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .setting-info {
            flex: 1;
        }
        
        .setting-label {
            display: block;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.25rem;
        }
        
        .setting-desc {
            display: block;
            color: var(--gray);
            font-size: 0.85rem;
        }
        
        .theme-toggle {
            display: flex;
            gap: 0.5rem;
            background-color: var(--gray-light);
            border-radius: var(--radius-md);
            padding: 0.25rem;
        }
        
        .theme-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: none;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            color: var(--gray);
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .theme-option.active {
            background-color: white;
            color: var(--dark);
            box-shadow: var(--shadow-md);
        }
        
        .lang-selector {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .lang-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: none;
            border: 1px solid var(--gray-light);
            border-radius: var(--radius-md);
            cursor: pointer;
            color: var(--dark);
            transition: all 0.3s;
            text-align: left;
        }
        
        .lang-option.active {
            border-color: var(--primary);
            background-color: rgba(0, 102, 204, 0.1);
        }
        
        .lang-flag {
            width: 24px;
            height: 16px;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .lang-flag.ru {
            background: linear-gradient(to bottom, white 33%, blue 33% 66%, red 66%);
        }
        
        .lang-flag.en {
            background-color: #00247D;
            position: relative;
        }
        
        .lang-flag.en::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(0deg, transparent 40%, white 40% 45%, transparent 45% 55%, white 55% 60%, transparent 60%),
                      linear-gradient(90deg, transparent 40%, white 40% 45%, transparent 45% 55%, white 55% 60%, transparent 60%);
        }
        
        .flag-icon {
            width: 24px;
            text-align: center;
            font-size: 1rem;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .notifications-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 1.5rem;
        }
        
        .notification-empty {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--gray);
        }
        
        .notification-empty i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        .notifications-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        
        /* –§–û–†–ú–´ –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò */
        .auth-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .auth-tab {
            flex: 1;
            padding: 1rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .auth-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }
        
        .form-group input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--gray-light);
            border-radius: var(--radius-md);
            font-size: 1rem;
            color: var(--dark);
            background-color: white;
            transition: all 0.3s;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }
        
        .form-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .checkbox input {
            width: auto;
        }
        
        .forgot-password {
            color: var(--primary);
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .forgot-password:hover {
            text-decoration: underline;
        }
        
        .auth-divider {
            text-align: center;
            margin: 2rem 0;
            position: relative;
        }
        
        .auth-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background-color: var(--gray-light);
        }
        
        .auth-divider span {
            background-color: white;
            padding: 0 1rem;
            color: var(--gray);
            position: relative;
            z-index: 1;
            font-size: 0.9rem;
        }
        
        .social-auth {
            display: flex;
            gap: 1rem;
        }
        
        .btn-social {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-lg);
            border: 1px solid var(--gray-light);
            background-color: white;
            color: var(--dark);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-social:hover {
            background-color: var(--gray-light);
        }
        
        .btn-social.google {
            border-color: #DB4437;
            color: #DB4437;
        }
        
        .btn-social.google:hover {
            background-color: rgba(219, 68, 55, 0.1);
        }
        
        .btn-social.anonymous {
            border-color: var(--gray);
            color: var(--gray);
        }
        
        .btn-social.anonymous:hover {
            background-color: rgba(108, 117, 125, 0.1);
        }
        
        /* –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è */
        .password-requirements {
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .password-strength {
            margin-top: 0.5rem;
        }
        
        .strength-bar {
            height: 4px;
            background-color: var(--gray-light);
            border-radius: 2px;
            margin-bottom: 0.25rem;
            overflow: hidden;
        }
        
        .strength-bar::after {
            content: '';
            display: block;
            height: 100%;
            width: 0%;
            background-color: var(--danger);
            transition: width 0.3s, background-color 0.3s;
        }
        
        .strength-text {
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .auth-error {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger);
            padding: 0.75rem 1rem;
            border-radius: var(--radius-md);
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        
        /* –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ */
        .avatar-upload {
            text-align: center;
        }
        
        .avatar-preview {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: var(--gray-light);
            margin: 0 auto 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .avatar-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .avatar-preview i {
            font-size: 4rem;
            color: var(--gray);
        }
        
        .avatar-message {
            padding: 0.75rem 1rem;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
        }
        
        .avatar-message.success {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success);
        }
        
        .avatar-message.error {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger);
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 1024px) {
            .header-container {
                flex-wrap: wrap;
                gap: 1rem;
            }
            
            .header-left {
                order: 1;
                min-width: auto;
            }
            
            .header-center {
                order: 3;
                width: 100%;
                margin-top: 1rem;
            }
            
            .header-right {
                order: 2;
                min-width: auto;
            }
            
            .search-container {
                width: 150px;
            }
            
            .search-input:focus {
                width: 200px;
            }
            
            .user-info {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .header-right {
                gap: 0.5rem;
            }
            
            .search-container {
                width: 40px;
            }
            
            .search-input {
                width: 40px;
                padding: 0.6rem;
            }
            
            .search-input:focus {
                width: 200px;
                padding: 0.6rem 1rem 0.6rem 2.5rem;
            }
            
            .breadcrumbs {
                font-size: 0.85rem;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .modal-content {
                width: 95%;
                margin: 1rem;
            }
            
            .modal-body {
                padding: 1.5rem;
            }
            
            .account-header {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .auth-buttons {
                flex-direction: column;
            }
            
            .social-auth {
                flex-direction: column;
            }
            
            .account-tabs {
                flex-direction: column;
            }
            
            .setting-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .notifications-actions {
                flex-direction: column;
            }
        }
    </style>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyB7h7qQ4FfKV6k7W5W9XqY4ZvJ8KpL9M0N", // –í–∞—à API –∫–ª—é—á
            projectId: "metronew-roblox", // –í–∞—à Project ID
            appId: "1:123456789012:web:abcdef1234567890", // –í–∞—à App ID
            authDomain: "metronew-roblox.firebaseapp.com",
            storageBucket: "metronew-roblox.appspot.com",
            messagingSenderId: "123456789012"
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        let firebaseApp, auth, db, storage, appCheck;

        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –≥–æ–¥
                document.getElementById('currentYear').textContent = new Date().getFullYear();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
                await initializeFirebase();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                initUI();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
                checkAuthState();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                showMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.', 'error');
            }
        });

        async function initializeFirebase() {
            try {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Firebase
                firebaseApp = firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                db = firebase.firestore();
                storage = firebase.storage();
                
                // –í–∫–ª—é—á–∞–µ–º App Check –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
                // –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ reCAPTCHA v3
                appCheck = firebase.appCheck();
                await appCheck.activate('6LcC3s0pAAAAAJjQHG3e9_2R0wKZ8g9d7b7gXqX7', true);
                
                console.log('Firebase —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:', error);
                throw error;
            }
        }

        function initUI() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–ø–∞–¥–∞—é—â–∏—Ö –º–µ–Ω—é
            initDropdowns();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            initModals();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º
            initForms();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
            initEventHandlers();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            loadSavedSettings();
        }

        function initDropdowns() {
            const userDropdown = document.getElementById('userDropdown');
            
            userDropdown.addEventListener('click', function(e) {
                e.stopPropagation();
                this.classList.toggle('show');
            });
            
            document.addEventListener('click', function() {
                userDropdown.classList.remove('show');
            });
        }

        function initModals() {
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–∫
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').classList.remove('show');
                });
            });
            
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('show');
                    }
                });
            });
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ –≤ –∞–∫–∫–∞—É–Ω—Ç–µ
            document.querySelectorAll('.account-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    document.querySelectorAll('.account-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.account-tab-content').forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `${tabName}Tab`) {
                            content.classList.add('active');
                        }
                    });
                });
            });
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.auth-form').forEach(form => {
                        form.classList.remove('active');
                        if (form.id === `${tabName}Form`) {
                            form.classList.add('active');
                        }
                    });
                });
            });
        }

        function initForms() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            const registerPassword = document.getElementById('registerPassword');
            const confirmPassword = document.getElementById('registerConfirmPassword');
            
            if (registerPassword) {
                registerPassword.addEventListener('input', function() {
                    checkPasswordStrength(this.value);
                });
                
                registerPassword.addEventListener('blur', function() {
                    validatePassword(this.value);
                });
            }
            
            if (confirmPassword) {
                confirmPassword.addEventListener('input', function() {
                    checkPasswordMatch();
                });
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ —Å–º–µ–Ω–µ
            const newPassword = document.getElementById('newPassword');
            if (newPassword) {
                newPassword.addEventListener('input', function() {
                    checkPasswordStrength(this.value);
                });
            }
        }

        function initEventHandlers() {
            // –ö–Ω–æ–ø–∫–∏ –≤ —Ö–µ–¥–µ—Ä–µ
            document.getElementById('aboutBtn')?.addEventListener('click', function(e) {
                e.preventDefault();
                showMessage('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞!');
            });
            
            // –ö–Ω–æ–ø–∫–∏ –≤ –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.addEventListener('click', function(e) {
                // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
                if (e.target.closest('#openAccountBtn')) {
                    e.preventDefault();
                    document.getElementById('accountModal').classList.add('show');
                    updateAccountModal();
                    document.getElementById('userDropdown').classList.remove('show');
                }
                
                // –û—Ç–∫—Ä—ã—Ç–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                if (e.target.closest('#openNotificationsBtn')) {
                    e.preventDefault();
                    document.getElementById('accountModal').classList.add('show');
                    document.querySelector('[data-tab="notifications"]').click();
                    document.getElementById('userDropdown').classList.remove('show');
                }
                
                // –í—Ö–æ–¥ —á–µ—Ä–µ–∑ –º–µ–Ω—é
                if (e.target.closest('#loginMenuBtn')) {
                    e.preventDefault();
                    document.getElementById('authModal').classList.add('show');
                    document.getElementById('userDropdown').classList.remove('show');
                }
                
                // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –º–µ–Ω—é
                if (e.target.closest('#registerMenuBtn')) {
                    e.preventDefault();
                    document.getElementById('authModal').classList.add('show');
                    document.querySelector('[data-tab="register"]').click();
                    document.getElementById('userDropdown').classList.remove('show');
                }
            });
            
            // –ö–Ω–æ–ø–∫–∏ –≤ –º–æ–¥–∞–ª–∫–µ –∞–∫–∫–∞—É–Ω—Ç–∞
            document.getElementById('loginBtn')?.addEventListener('click', function() {
                document.getElementById('accountModal').classList.remove('show');
                setTimeout(() => {
                    document.getElementById('authModal').classList.add('show');
                    document.querySelector('[data-tab="login"]').click();
                }, 300);
            });
            
            document.getElementById('registerBtn')?.addEventListener('click', function() {
                document.getElementById('accountModal').classList.remove('show');
                setTimeout(() => {
                    document.getElementById('authModal').classList.add('show');
                    document.querySelector('[data-tab="register"]').click();
                }, 300);
            });
            
            // –°–º–µ–Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞
            document.getElementById('changeAvatarBtn')?.addEventListener('click', function() {
                document.getElementById('avatarModal').classList.add('show');
                initAvatarUpload();
            });
            
            // –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
            document.getElementById('changePasswordBtn')?.addEventListener('click', function() {
                document.getElementById('changePasswordModal').classList.add('show');
            });
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
            document.getElementById('forgotPasswordBtn')?.addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('authModal').classList.remove('show');
                setTimeout(() => {
                    document.getElementById('passwordResetModal').classList.add('show');
                }, 300);
            });
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Å—ã–ª–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
            document.getElementById('sendResetBtn')?.addEventListener('click', async function() {
                await sendPasswordReset();
            });
            
            // –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
            document.getElementById('changePasswordSubmitBtn')?.addEventListener('click', async function() {
                await changePassword();
            });
            
            // –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google
            document.getElementById('googleLoginBtn')?.addEventListener('click', async function() {
                await signInWithGoogle();
            });
            
            // –ì–æ—Å—Ç–µ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
            document.getElementById('anonymousLoginBtn')?.addEventListener('click', async function() {
                await signInAnonymously();
            });
            
            // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞
            document.getElementById('loginForm')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                await signInWithEmail();
            });
            
            // –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            document.getElementById('registerForm')?.addEventListener('submit', async function(e) {
                e.preventDefault();
                await signUpWithEmail();
            });
            
            // –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞ –∞–≤–∞—Ç–∞—Ä–∞
            document.getElementById('chooseAvatarBtn')?.addEventListener('click', function() {
                document.getElementById('avatarFileInput').click();
            });
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞
            document.getElementById('uploadAvatarBtn')?.addEventListener('click', async function() {
                await uploadAvatar();
            });
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞
            document.getElementById('removeAvatarBtn')?.addEventListener('click', async function() {
                await removeAvatar();
            });
            
            // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –∞–≤–∞—Ç–∞—Ä–∞
            document.getElementById('avatarFileInput')?.addEventListener('change', function(e) {
                previewAvatar(e.target.files[0]);
            });
        }

        function loadSavedSettings() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–º—É
            const savedTheme = localStorage.getItem('theme') || 'light';
            const themeOption = document.querySelector(`.theme-option[data-theme="${savedTheme}"]`);
            if (themeOption) {
                themeOption.click();
                if (savedTheme === 'dark') {
                    document.body.classList.add('dark-theme');
                } else {
                    document.body.classList.remove('dark-theme');
                }
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —è–∑—ã–∫
            const savedLang = localStorage.getItem('language') || 'ru';
            const langOption = document.querySelector(`.lang-option[data-lang="${savedLang}"]`);
            if (langOption) {
                langOption.click();
            }
        }

        function checkAuthState() {
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                    await updateUserProfile(user);
                    await loadUserData(user.uid);
                } else {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                    updateGuestProfile();
                }
            });
        }

        async function updateUserProfile(user) {
            const displayName = user.displayName || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            const email = user.email || '–ë–µ–∑ email';
            const photoURL = user.photoURL;
            const isAnonymous = user.isAnonymous;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ö–µ–¥–µ—Ä
            document.getElementById('userName').textContent = isAnonymous ? '–ì–æ—Å—Ç—å' : displayName;
            document.getElementById('userStatus').textContent = isAnonymous ? '–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º' : email;
            
            const userAvatar = document.getElementById('userAvatar');
            if (photoURL) {
                userAvatar.innerHTML = `<img src="${photoURL}" alt="${displayName}">`;
            } else {
                userAvatar.innerHTML = '<i class="fas fa-user-circle"></i>';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            updateUserMenu(user);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–¥–∞–ª–∫—É –∞–∫–∫–∞—É–Ω—Ç–∞
            updateAccountModal(user);
        }

        function updateGuestProfile() {
            document.getElementById('userName').textContent = '–ì–æ—Å—Ç—å';
            document.getElementById('userStatus').textContent = '–í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç';
            document.getElementById('userAvatar').innerHTML = '<i class="fas fa-user-circle"></i>';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–µ–Ω—é –¥–ª—è –≥–æ—Å—Ç—è
            updateGuestMenu();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–¥–∞–ª–∫—É –∞–∫–∫–∞—É–Ω—Ç–∞ –¥–ª—è –≥–æ—Å—Ç—è
            updateGuestAccountModal();
        }

        function updateUserMenu(user) {
            const userMenu = document.getElementById('userMenu');
            const displayName = user.displayName || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            const email = user.email || '–ë–µ–∑ email';
            const isAnonymous = user.isAnonymous;
            
            userMenu.innerHTML = `
                <div class="dropdown-header" style="padding: 0.75rem 1rem;">
                    <div style="font-weight: 600;">${isAnonymous ? '–ì–æ—Å—Ç—å' : displayName}</div>
                    <small style="color: var(--gray);">${isAnonymous ? '–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º' : email}</small>
                </div>
                <div class="dropdown-divider"></div>
                <button class="dropdown-item" id="openAccountBtn">
                    <i class="fas fa-user-circle"></i>
                    <span>–ú–æ–π –∞–∫–∫–∞—É–Ω—Ç</span>
                </button>
                <button class="dropdown-item" id="openNotificationsBtn">
                    <i class="fas fa-bell"></i>
                    <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                </button>
                <div class="dropdown-divider"></div>
                ${isAnonymous ? `
                    <button class="dropdown-item" id="upgradeAccountBtn">
                        <i class="fas fa-user-plus"></i>
                        <span>–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</span>
                    </button>
                ` : ''}
                <button class="dropdown-item logout" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>${isAnonymous ? '–í—ã–π—Ç–∏ –∏–∑ –≥–æ—Å—Ç–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞' : '–í—ã–π—Ç–∏'}</span>
                </button>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            setTimeout(() => {
                document.getElementById('logoutBtn')?.addEventListener('click', signOut);
                document.getElementById('upgradeAccountBtn')?.addEventListener('click', function() {
                    document.getElementById('userDropdown').classList.remove('show');
                    document.getElementById('authModal').classList.add('show');
                    document.querySelector('[data-tab="register"]').click();
                });
            }, 100);
        }

        function updateGuestMenu() {
            const userMenu = document.getElementById('userMenu');
            
            userMenu.innerHTML = `
                <div class="dropdown-header" style="padding: 0.75rem 1rem;">
                    <div style="font-weight: 600;">–ì–æ—Å—Ç—å</div>
                    <small style="color: var(--gray);">–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω</small>
                </div>
                <div class="dropdown-divider"></div>
                <button class="dropdown-item" id="openAccountBtn">
                    <i class="fas fa-user-circle"></i>
                    <span>–ú–æ–π –∞–∫–∫–∞—É–Ω—Ç</span>
                </button>
                <button class="dropdown-item" id="openNotificationsBtn">
                    <i class="fas fa-bell"></i>
                    <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                </button>
                <div class="dropdown-divider"></div>
                <button class="dropdown-item" id="loginMenuBtn">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>–í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç</span>
                </button>
                <button class="dropdown-item" id="registerMenuBtn">
                    <i class="fas fa-user-plus"></i>
                    <span>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</span>
                </button>
                <button class="dropdown-item" id="guestLoginBtn">
                    <i class="fas fa-user-secret"></i>
                    <span>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫–∞–∫ –≥–æ—Å—Ç—å</span>
                </button>
            `;
        }

        function updateAccountModal(user) {
            if (user) {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                const displayName = user.displayName || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                const email = user.email || '–ë–µ–∑ email';
                const isAnonymous = user.isAnonymous;
                const uid = user.uid;
                const creationTime = user.metadata.creationTime;
                const lastSignInTime = user.metadata.lastSignInTime;
                
                document.getElementById('accountName').textContent = isAnonymous ? '–ì–æ—Å—Ç—å' : displayName;
                document.getElementById('accountEmail').textContent = isAnonymous ? '–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º' : email;
                document.getElementById('accountBadge').textContent = isAnonymous ? '–ì–æ—Å—Ç—å' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('profileStatus').textContent = isAnonymous ? '–ì–æ—Å—Ç—å' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('profileRegDate').textContent = new Date(creationTime).toLocaleDateString('ru-RU');
                document.getElementById('profileLastLogin').textContent = new Date(lastSignInTime).toLocaleDateString('ru-RU');
                document.getElementById('profileUID').textContent = uid.substring(0, 8) + '...';
                
                const accountAvatar = document.getElementById('accountAvatar');
                if (user.photoURL) {
                    accountAvatar.innerHTML = `<img src="${user.photoURL}" alt="${displayName}">`;
                } else {
                    accountAvatar.innerHTML = '<i class="fas fa-user-circle"></i>';
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –Ω–µ–∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                if (!isAnonymous) {
                    document.getElementById('profileActionsSection').style.display = 'block';
                    document.getElementById('authNote').textContent = '–í—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã';
                } else {
                    document.getElementById('profileActionsSection').style.display = 'none';
                    document.getElementById('authNote').textContent = '–í—ã –≤ –≥–æ—Å—Ç–µ–≤–æ–º —Ä–µ–∂–∏–º–µ. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å.';
                }
                
            } else {
                // –ì–æ—Å—Ç—å
                updateGuestAccountModal();
            }
        }

        function updateGuestAccountModal() {
            document.getElementById('accountName').textContent = '–ì–æ—Å—Ç—å';
            document.getElementById('accountEmail').textContent = '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
            document.getElementById('accountBadge').textContent = '–ì–æ—Å—Ç—å';
            document.getElementById('profileStatus').textContent = '–ì–æ—Å—Ç—å';
            document.getElementById('profileRegDate').textContent = '‚Äî';
            document.getElementById('profileLastLogin').textContent = '‚Äî';
            document.getElementById('profileUID').textContent = '‚Äî';
            document.getElementById('accountAvatar').innerHTML = '<i class="fas fa-user-circle"></i>';
            document.getElementById('profileActionsSection').style.display = 'none';
            document.getElementById('authNote').textContent = '–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º';
        }

        // –§—É–Ω–∫—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        async function signInWithEmail() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            
            const loginSubmitBtn = document.getElementById('loginSubmitBtn');
            const loginError = document.getElementById('loginError');
            
            try {
                loginSubmitBtn.disabled = true;
                loginSubmitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –í—Ö–æ–¥...';
                loginError.style.display = 'none';
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ persistence
                const persistence = rememberMe ? 
                    firebase.auth.Auth.Persistence.LOCAL : 
                    firebase.auth.Auth.Persistence.SESSION;
                
                await auth.setPersistence(persistence);
                
                // –í—Ö–æ–¥
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                
                showMessage(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${userCredential.user.email}!`);
                document.getElementById('authModal').classList.remove('show');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                
                let errorMessage = '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞. ';
                switch (error.code) {
                    case 'auth/invalid-email':
                        errorMessage += '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email.';
                        break;
                    case 'auth/user-disabled':
                        errorMessage += '–ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω.';
                        break;
                    case 'auth/user-not-found':
                        errorMessage += '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω.';
                        break;
                    case 'auth/wrong-password':
                        errorMessage += '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å.';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage += '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
                        break;
                    default:
                        errorMessage += error.message;
                }
                
                loginError.textContent = errorMessage;
                loginError.style.display = 'block';
                
            } finally {
                loginSubmitBtn.disabled = false;
                loginSubmitBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏';
            }
        }

        async function signUpWithEmail() {
            const username = document.getElementById('registerUsername').value.trim();
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const agreeTerms = document.getElementById('agreeTerms').checked;
            
            const registerSubmitBtn = document.getElementById('registerSubmitBtn');
            const registerError = document.getElementById('registerError');
            
            try {
                // –í–∞–ª–∏–¥–∞—Ü–∏—è
                if (!username) {
                    throw new Error('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                }
                
                if (!agreeTerms) {
                    throw new Error('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–≥–ª–∞—Å–∏—Ç—å—Å—è —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏');
                }
                
                if (password !== confirmPassword) {
                    throw new Error('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
                const passwordValidation = validatePassword(password);
                if (!passwordValidation.valid) {
                    throw new Error(passwordValidation.message);
                }
                
                registerSubmitBtn.disabled = true;
                registerSubmitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...';
                registerError.style.display = 'none';
                
                // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
                await userCredential.user.updateProfile({
                    displayName: username
                });
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ Firestore
                await saveUserData(userCredential.user.uid, {
                    username: username,
                    email: email,
                    createdAt: new Date().toISOString(),
                    settings: {
                        theme: 'light',
                        language: 'ru',
                        emailNotifications: true,
                        projectNews: true
                    }
                });
                
                showMessage(`–ê–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${username}!`);
                document.getElementById('authModal').classList.remove('show');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
                
                let errorMessage = '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. ';
                switch (error.code) {
                    case 'auth/email-already-in-use':
                        errorMessage += 'Email —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage += '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email.';
                        break;
                    case 'auth/operation-not-allowed':
                        errorMessage += '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ email –æ—Ç–∫–ª—é—á–µ–Ω–∞.';
                        break;
                    case 'auth/weak-password':
                        errorMessage += '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–π. –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤: –∑–∞–≥–ª–∞–≤–Ω—ã–µ, —Å—Ç—Ä–æ—á–Ω—ã–µ, —Ü–∏—Ñ—Ä—ã, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã.';
                        break;
                    case 'auth/network-request-failed':
                        errorMessage += '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.';
                        break;
                    case 'auth/quota-exceeded':
                        errorMessage += '–ü—Ä–µ–≤—ã—à–µ–Ω–∞ –∫–≤–æ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
                        break;
                    default:
                        errorMessage += error.message;
                }
                
                registerError.textContent = errorMessage;
                registerError.style.display = 'block';
                
            } finally {
                registerSubmitBtn.disabled = false;
                registerSubmitBtn.innerHTML = '<i class="fas fa-user-plus"></i> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è';
            }
        }

        async function signInWithGoogle() {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                provider.addScope('profile');
                provider.addScope('email');
                
                const result = await auth.signInWithPopup(provider);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–æ–≤—ã–π –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                if (result.additionalUserInfo?.isNewUser) {
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    await saveUserData(result.user.uid, {
                        username: result.user.displayName,
                        email: result.user.email,
                        createdAt: new Date().toISOString(),
                        settings: {
                            theme: 'light',
                            language: 'ru',
                            emailNotifications: true,
                            projectNews: true
                        }
                    });
                }
                
                showMessage(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Google, ${result.user.displayName}!`);
                document.getElementById('authModal').classList.remove('show');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google:', error);
                
                let errorMessage = '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google. ';
                switch (error.code) {
                    case 'auth/popup-blocked':
                        errorMessage += '–í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ. –†–∞–∑—Ä–µ—à–∏—Ç–µ –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞.';
                        break;
                    case 'auth/popup-closed-by-user':
                        errorMessage = '–û–∫–Ω–æ –≤—Ö–æ–¥–∞ –∑–∞–∫—Ä—ã—Ç–æ.';
                        break;
                    case 'auth/cancelled-popup-request':
                        errorMessage = '–ó–∞–ø—Ä–æ—Å –æ—Ç–º–µ–Ω—ë–Ω.';
                        break;
                    default:
                        errorMessage += error.message;
                }
                
                showMessage(errorMessage, 'error');
            }
        }

        async function signInAnonymously() {
            try {
                const userCredential = await auth.signInAnonymously();
                
                showMessage('–í—Ö–æ–¥ –≤ –≥–æ—Å—Ç–µ–≤–æ–º —Ä–µ–∂–∏–º–µ. –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –ª–æ–∫–∞–ª—å–Ω–æ.');
                document.getElementById('authModal').classList.remove('show');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≥–æ—Å—Ç–µ–≤–æ–≥–æ –≤—Ö–æ–¥–∞:', error);
                showMessage('–û—à–∏–±–∫–∞ –≥–æ—Å—Ç–µ–≤–æ–≥–æ –≤—Ö–æ–¥–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.', 'error');
            }
        }

        async function signOut() {
            try {
                await auth.signOut();
                showMessage('–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
                showMessage('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.', 'error');
            }
        }

        async function sendPasswordReset() {
            const email = document.getElementById('resetEmail').value;
            const sendResetBtn = document.getElementById('sendResetBtn');
            const resetMessage = document.getElementById('resetMessage');
            
            if (!email) {
                resetMessage.textContent = '–í–≤–µ–¥–∏—Ç–µ email';
                resetMessage.style.color = 'var(--danger)';
                resetMessage.style.display = 'block';
                return;
            }
            
            try {
                sendResetBtn.disabled = true;
                sendResetBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –û—Ç–ø—Ä–∞–≤–∫–∞...';
                
                await auth.sendPasswordResetEmail(email);
                
                resetMessage.textContent = `–°—Å—ã–ª–∫–∞ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ ${email}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É.`;
                resetMessage.style.color = 'var(--success)';
                resetMessage.style.display = 'block';
                
                setTimeout(() => {
                    document.getElementById('passwordResetModal').classList.remove('show');
                }, 3000);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è:', error);
                
                let errorMessage = '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å—Å—ã–ª–∫–∏. ';
                switch (error.code) {
                    case 'auth/invalid-email':
                        errorMessage += '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email.';
                        break;
                    case 'auth/user-not-found':
                        errorMessage += '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω.';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage += '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';
                        break;
                    default:
                        errorMessage += error.message;
                }
                
                resetMessage.textContent = errorMessage;
                resetMessage.style.color = 'var(--danger)';
                resetMessage.style.display = 'block';
                
            } finally {
                sendResetBtn.disabled = false;
                sendResetBtn.innerHTML = '<i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É';
            }
        }

        async function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmNewPassword = document.getElementById('confirmNewPassword').value;
            const user = auth.currentUser;
            
            const changePasswordSubmitBtn = document.getElementById('changePasswordSubmitBtn');
            const passwordChangeMessage = document.getElementById('passwordChangeMessage');
            
            if (!user || user.isAnonymous) {
                passwordChangeMessage.textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –≥–æ—Å—Ç–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞';
                passwordChangeMessage.style.color = 'var(--danger)';
                passwordChangeMessage.style.display = 'block';
                return;
            }
            
            try {
                // –í–∞–ª–∏–¥–∞—Ü–∏—è
                if (newPassword !== confirmNewPassword) {
                    throw new Error('–ù–æ–≤—ã–µ –ø–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
                }
                
                const passwordValidation = validatePassword(newPassword);
                if (!passwordValidation.valid) {
                    throw new Error(passwordValidation.message);
                }
                
                changePasswordSubmitBtn.disabled = true;
                changePasswordSubmitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
                passwordChangeMessage.style.display = 'none';
                
                // –†–µ-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
                const credential = firebase.auth.EmailAuthProvider.credential(user.email, currentPassword);
                await user.reauthenticateWithCredential(credential);
                
                // –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
                await user.updatePassword(newPassword);
                
                passwordChangeMessage.textContent = '–ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω—ë–Ω!';
                passwordChangeMessage.style.color = 'var(--success)';
                passwordChangeMessage.style.display = 'block';
                
                setTimeout(() => {
                    document.getElementById('changePasswordModal').classList.remove('show');
                    document.getElementById('currentPassword').value = '';
                    document.getElementById('newPassword').value = '';
                    document.getElementById('confirmNewPassword').value = '';
                }, 2000);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è:', error);
                
                let errorMessage = '–û—à–∏–±–∫–∞ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è. ';
                switch (error.code) {
                    case 'auth/wrong-password':
                        errorMessage += '–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å.';
                        break;
                    case 'auth/weak-password':
                        errorMessage += '–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–π. –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤: –∑–∞–≥–ª–∞–≤–Ω—ã–µ, —Å—Ç—Ä–æ—á–Ω—ã–µ, —Ü–∏—Ñ—Ä—ã, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã.';
                        break;
                    case 'auth/requires-recent-login':
                        errorMessage += '–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥ –¥–ª—è —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è.';
                        break;
                    default:
                        errorMessage += error.message;
                }
                
                passwordChangeMessage.textContent = errorMessage;
                passwordChangeMessage.style.color = 'var(--danger)';
                passwordChangeMessage.style.display = 'block';
                
            } finally {
                changePasswordSubmitBtn.disabled = false;
                changePasswordSubmitBtn.innerHTML = '<i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å';
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function validatePassword(password) {
            const minLength = 8;
            const maxLength = 32;
            
            if (password.length < minLength) {
                return {
                    valid: false,
                    message: `–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ ${minLength} —Å–∏–º–≤–æ–ª–æ–≤`
                };
            }
            
            if (password.length > maxLength) {
                return {
                    valid: false,
                    message: `–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –±–æ–ª–µ–µ ${maxLength} —Å–∏–º–≤–æ–ª–æ–≤`
                };
            }
            
            const hasUpperCase = /[A-Z]/.test(password);
            const hasLowerCase = /[a-z]/.test(password);
            const hasNumbers = /\d/.test(password);
            const hasSpecialChar = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password);
            
            if (!hasUpperCase) {
                return {
                    valid: false,
                    message: '–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∑–∞–≥–ª–∞–≤–Ω—É—é –±—É–∫–≤—É'
                };
            }
            
            if (!hasLowerCase) {
                return {
                    valid: false,
                    message: '–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Å—Ç—Ä–æ—á–Ω—É—é –±—É–∫–≤—É'
                };
            }
            
            if (!hasNumbers) {
                return {
                    valid: false,
                    message: '–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Ü–∏—Ñ—Ä—É'
                };
            }
            
            if (!hasSpecialChar) {
                return {
                    valid: false,
                    message: '–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª (!@#$%^&* –∏ —Ç.–¥.)'
                };
            }
            
            return { valid: true, message: '–ü–∞—Ä–æ–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º' };
        }

        function checkPasswordStrength(password) {
            const strengthBar = document.querySelector('.strength-bar');
            const strengthText = document.getElementById('strengthText');
            
            if (!password) {
                strengthBar.style.width = '0%';
                strengthBar.style.backgroundColor = 'var(--danger)';
                strengthText.textContent = '—Å–ª–∞–±—ã–π';
                return;
            }
            
            let strength = 0;
            
            // –î–ª–∏–Ω–∞
            if (password.length >= 8) strength += 25;
            if (password.length >= 12) strength += 10;
            
            // –°–ª–æ–∂–Ω–æ—Å—Ç—å
            if (/[A-Z]/.test(password)) strength += 15;
            if (/[a-z]/.test(password)) strength += 15;
            if (/\d/.test(password)) strength += 15;
            if (/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)) strength += 20;
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º 100%
            strength = Math.min(strength, 100);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            strengthBar.style.width = `${strength}%`;
            
            if (strength < 40) {
                strengthBar.style.backgroundColor = 'var(--danger)';
                strengthText.textContent = '—Å–ª–∞–±—ã–π';
            } else if (strength < 70) {
                strengthBar.style.backgroundColor = 'var(--warning)';
                strengthText.textContent = '—Å—Ä–µ–¥–Ω–∏–π';
            } else {
                strengthBar.style.backgroundColor = 'var(--success)';
                strengthText.textContent = '—Å–∏–ª—å–Ω—ã–π';
            }
        }

        function checkPasswordMatch() {
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const passwordMatch = document.getElementById('passwordMatch');
            
            if (password && confirmPassword) {
                if (password === confirmPassword) {
                    passwordMatch.style.display = 'block';
                } else {
                    passwordMatch.style.display = 'none';
                }
            }
        }

        async function saveUserData(uid, data) {
            try {
                await db.collection('users').doc(uid).set(data, { merge: true });
                console.log('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
            }
        }

        async function loadUserData(uid) {
            try {
                const doc = await db.collection('users').doc(uid).get();
                if (doc.exists) {
                    console.log('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', doc.data());
                    return doc.data();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
            }
            return null;
        }

        function initAvatarUpload() {
            const user = auth.currentUser;
            if (!user || user.isAnonymous) {
                document.getElementById('avatarMessage').textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –≥–æ—Å—Ç–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞';
                document.getElementById('avatarMessage').style.color = 'var(--danger)';
                document.getElementById('avatarMessage').style.display = 'block';
                document.getElementById('uploadAvatarBtn').disabled = true;
                return;
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            document.getElementById('avatarPreviewImg').style.display = 'none';
            document.getElementById('avatarPreviewIcon').style.display = 'block';
            document.getElementById('removeAvatarBtn').style.display = user.photoURL ? 'inline-flex' : 'none';
            document.getElementById('uploadAvatarBtn').disabled = true;
            document.getElementById('avatarMessage').style.display = 'none';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –∞–≤–∞—Ç–∞—Ä
            if (user.photoURL) {
                document.getElementById('avatarPreviewImg').src = user.photoURL;
                document.getElementById('avatarPreviewImg').style.display = 'block';
                document.getElementById('avatarPreviewIcon').style.display = 'none';
            }
        }

        function previewAvatar(file) {
            if (!file) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –∏ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
            const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            const maxSize = 2 * 1024 * 1024; // 2MB
            
            if (!validTypes.includes(file.type)) {
                document.getElementById('avatarMessage').textContent = '–¢–æ–ª—å–∫–æ JPG, PNG, GIF –∏–ª–∏ WebP';
                document.getElementById('avatarMessage').style.color = 'var(--danger)';
                document.getElementById('avatarMessage').style.display = 'block';
                return;
            }
            
            if (file.size > maxSize) {
                document.getElementById('avatarMessage').textContent = '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 2MB';
                document.getElementById('avatarMessage').style.color = 'var(--danger)';
                document.getElementById('avatarMessage').style.display = 'block';
                return;
            }
            
            // –ü—Ä–µ–≤—å—é
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('avatarPreviewImg').src = e.target.result;
                document.getElementById('avatarPreviewImg').style.display = 'block';
                document.getElementById('avatarPreviewIcon').style.display = 'none';
                document.getElementById('uploadAvatarBtn').disabled = false;
                document.getElementById('avatarMessage').style.display = 'none';
            };
            reader.readAsDataURL(file);
        }

        async function uploadAvatar() {
            const fileInput = document.getElementById('avatarFileInput');
            const file = fileInput.files[0];
            const user = auth.currentUser;
            
            if (!file || !user || user.isAnonymous) return;
            
            const uploadBtn = document.getElementById('uploadAvatarBtn');
            const avatarMessage = document.getElementById('avatarMessage');
            
            try {
                uploadBtn.disabled = true;
                uploadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞...';
                avatarMessage.style.display = 'none';
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤ Storage
                const storageRef = storage.ref();
                const avatarRef = storageRef.child(`avatars/${user.uid}/${file.name}`);
                const snapshot = await avatarRef.put(file);
                const downloadURL = await snapshot.ref.getDownloadURL();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
                await user.updateProfile({
                    photoURL: downloadURL
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º URL –≤ Firestore
                await saveUserData(user.uid, {
                    avatarUrl: downloadURL
                });
                
                avatarMessage.textContent = '–ê–≤–∞—Ç–∞—Ä —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª—ë–Ω!';
                avatarMessage.style.color = 'var(--success)';
                avatarMessage.style.display = 'block';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                setTimeout(() => {
                    document.getElementById('avatarModal').classList.remove('show');
                    updateUserProfile(user);
                    updateAccountModal(user);
                }, 1500);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞:', error);
                
                avatarMessage.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.';
                avatarMessage.style.color = 'var(--danger)';
                avatarMessage.style.display = 'block';
                
            } finally {
                uploadBtn.disabled = false;
                uploadBtn.innerHTML = '<i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä';
            }
        }

        async function removeAvatar() {
            const user = auth.currentUser;
            if (!user || user.isAnonymous) return;
            
            try {
                // –£–¥–∞–ª—è–µ–º –∏–∑ Storage (–µ—Å–ª–∏ –±—ã–ª –∑–∞–≥—Ä—É–∂–µ–Ω)
                if (user.photoURL && user.photoURL.includes('firebasestorage')) {
                    try {
                        const photoRef = storage.refFromURL(user.photoURL);
                        await photoRef.delete();
                    } catch (storageError) {
                        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∏–∑ Storage:', storageError);
                    }
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
                await user.updateProfile({
                    photoURL: null
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º Firestore
                await saveUserData(user.uid, {
                    avatarUrl: null
                });
                
                showMessage('–ê–≤–∞—Ç–∞—Ä —É–¥–∞–ª—ë–Ω');
                document.getElementById('avatarModal').classList.remove('show');
                updateUserProfile(user);
                updateAccountModal(user);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞:', error);
                showMessage('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞', 'error');
            }
        }

        function showMessage(message, type = 'success') {
            const messageEl = document.createElement('div');
            messageEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? 'var(--danger)' : 'var(--primary)'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: var(--radius-lg);
                box-shadow: var(--shadow-lg);
                z-index: 3000;
                animation: slideIn 0.3s ease;
                max-width: 300px;
                font-weight: 500;
            `;
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            messageEl.textContent = message;
            document.body.appendChild(messageEl);
            
            setTimeout(() => {
                messageEl.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => {
                    document.body.removeChild(messageEl);
                    document.head.removeChild(style);
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>
