<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å | –ú–µ—Ç—Ä–æ New</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    
    <style>
        :root {
            --primary: #0066CC;
            --primary-dark: #0052a3;
            --primary-light: #4d94ff;
            --secondary: #FFD700;
            --secondary-dark: #e6c200;
            --dark: #1A1A1A;
            --light: #F8F9FA;
            --gray: #6C757D;
            --success: #28A745;
            --warning: #FFC107;
            --danger: #DC3545;
            --shadow-md: 0 4px 12px rgba(0,0,0,0.15);
            --shadow-lg: 0 8px 25px rgba(0,0,0,0.2);
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 15px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            width: 90%;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 1rem 0;
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .logo-icon {
            width: 35px;
            height: 35px;
            background-color: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark);
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .nav-links {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            transition: all 0.3s ease;
        }
        
        .nav-links a:hover {
            background-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }
        
        .nav-links a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        main {
            padding: 2rem 0;
            min-height: calc(100vh - 150px);
        }
        
        .page-header {
            background: linear-gradient(rgba(0, 82, 163, 0.8), rgba(0, 102, 204, 0.9)), url('https://placehold.co/1200x400/1a1a1a/FFFFFF?text=–û–±—Ä–∞—Ç–Ω–∞—è+—Å–≤—è–∑—å') center/cover no-repeat;
            border-radius: var(--radius-xl);
            padding: 3rem 2rem;
            color: white;
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .page-header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .page-header p {
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto;
            opacity: 0.9;
        }
        
        .contact-form {
            background: white;
            border-radius: var(--radius-xl);
            padding: 2.5rem;
            box-shadow: var(--shadow-md);
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #ddd;
            border-radius: var(--radius-md);
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }
        
        textarea.form-control {
            resize: vertical;
            min-height: 120px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .checkbox-group input {
            margin-top: 0.25rem;
        }
        
        .checkbox-group label {
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .checkbox-group a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .checkbox-group a:hover {
            text-decoration: underline;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            color: var(--dark);
            border: none;
            border-radius: var(--radius-lg);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            box-shadow: var(--shadow-md);
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .alert {
            padding: 1rem;
            border-radius: var(--radius-md);
            margin-bottom: 1.5rem;
            display: none;
        }
        
        .alert-success {
            background-color: rgba(40, 167, 69, 0.1);
            border: 1px solid var(--success);
            color: var(--success);
        }
        
        .alert-error {
            background-color: rgba(220, 53, 69, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
        }
        
        .ticket-info {
            background: #e8f4fd;
            border-radius: var(--radius-md);
            padding: 1.5rem;
            margin-top: 1.5rem;
            border-left: 4px solid var(--primary);
        }
        
        .ticket-id {
            font-family: monospace;
            background: var(--dark);
            color: var(--secondary);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            font-size: 1.1rem;
            font-weight: bold;
        }
        
        .info-box {
            background: #fff3cd;
            border-radius: var(--radius-md);
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--warning);
        }
        
        .status-check {
            background: white;
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-md);
            margin-top: 2rem;
        }
        
        .status-check-form {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .status-check-form input {
            flex: 1;
        }
        
        .status-result {
            display: none;
            background: var(--light);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            margin-top: 1rem;
        }
        
        .status-result.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            nav {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .page-header h1 {
                font-size: 2rem;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .status-check-form {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <span class="logo-icon">M</span>
                    <span>–ú–µ—Ç—Ä–æ New</span>
                </div>
                <div class="nav-links">
                    <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
                    <a href="contact.html" class="active">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</a>
                    <a href="control-center.html">–¶–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</a>
                    <a href="https://www.roblox.com/communities/34820737/RP-NEW">–ò–≥—Ä–∞</a>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <section class="page-header">
            <h1>üì® –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</h1>
            <p>–°–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –ø—Ä–æ–µ–∫—Ç–∞. –ú—ã –æ—Ç–≤–µ—Ç–∏–º –≤ –∫—Ä–∞—Ç—á–∞–π—à–∏–µ —Å—Ä–æ–∫–∏!</p>
        </section>

        <div class="info-box">
            <h3>üìã –í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –Ω–∏–∂–µ –¥–ª—è —Å–≤—è–∑–∏ —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –ø—Ä–æ–µ–∫—Ç–∞. –£–∫–∞–∂–∏—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏.</p>
        </div>

        <div class="contact-form">
            <h2>–§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</h2>
            <div id="alert-message" class="alert"></div>
            
            <form id="feedbackForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="name">–í–∞—à–µ –∏–º—è *</label>
                        <input type="text" id="name" name="name" class="form-control" placeholder="–ö–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è?" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞ *</label>
                        <input type="email" id="email" name="email" class="form-control" placeholder="your@email.com" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="position">–í–∞—à–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç—å *</label>
                        <select id="position" name="position" class="form-control" required>
                            <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å</option>
                            <option value="player">üéÆ –ò–≥—Ä–æ–∫</option>
                            <option value="developer">üíª –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</option>
                            <option value="moderator">üõ°Ô∏è –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
                            <option value="admin">üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                            <option value="other">‚ùì –î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="specialCode">–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–¥</label>
                        <input type="text" id="specialCode" name="specialCode" class="form-control" placeholder="–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Å–ø–µ—Ü–∫–æ–¥">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="contactMethod">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–≤—è–∑–∏</label>
                        <select id="contactMethod" name="contactMethod" class="form-control">
                            <option value="" selected>–ù–µ —É–∫–∞–∑—ã–≤–∞—Ç—å</option>
                            <option value="discord">Discord</option>
                            <option value="telegram">Telegram</option>
                            <option value="vk">VK</option>
                            <option value="roblox">Roblox</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="contactDetails">–î–∞–Ω–Ω—ã–µ –¥–ª—è —Å–≤—è–∑–∏</label>
                        <input type="text" id="contactDetails" name="contactDetails" class="form-control" placeholder="username#1234 –∏–ª–∏ @username">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="message">–°–æ–æ–±—â–µ–Ω–∏–µ *</label>
                    <textarea id="message" name="message" class="form-control" placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É..." required></textarea>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="privacy-policy" name="privacy-policy" required>
                    <label for="privacy-policy">
                        –Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å <a href="https://kirill12633.github.io/Metro.New.Official/Rules/privacy-policy.html" target="_blank">–ü–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a> *
                    </label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="terms-of-service" name="terms-of-service" required>
                    <label for="terms-of-service">
                        –Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å <a href="https://kirill12633.github.io/Metro.New.Official/Rules/terms-of-service.html" target="_blank">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ–º</a> *
                    </label>
                </div>
                
                <button type="submit" class="btn" id="submitBtn">
                    <i class="fas fa-paper-plane"></i>
                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ
                </button>
            </form>
            
            <div id="ticketSuccess" style="display: none;">
                <div class="ticket-info">
                    <h3>‚úÖ –û–±—Ä–∞—â–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!</h3>
                    <p>–í–∞—à –Ω–æ–º–µ—Ä —Ç–∏–∫–µ—Ç–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:</p>
                    <div class="ticket-id" id="ticketNumber">MN-2024-001</div>
                    <p style="margin-top: 1rem; font-size: 0.9rem;">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç –Ω–æ–º–µ—Ä! –° –µ–≥–æ –ø–æ–º–æ—â—å—é –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞—â–µ–Ω–∏—è.
                    </p>
                </div>
            </div>
        </div>

        <div class="status-check">
            <h2>üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞—â–µ–Ω–∏—è</h2>
            <div class="status-check-form">
                <input type="text" id="checkTicketId" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–∏–∫–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: MN-2024-001)">
                <button class="btn" onclick="checkTicketStatus()" style="width: auto;">
                    <i class="fas fa-search"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
                </button>
            </div>
            <div class="status-result" id="statusResult">
                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ -->
            </div>
        </div>
    </main>

    <script>
        // ‚úÖ –í–ê–®–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø FIREBASE
        const firebaseConfig = {
            apiKey: "AIzaSyDNAyhui3Lc_IX0wuot7_Z6Vdf9Bw5A9mE",
            authDomain: "metro-new-85226.firebaseapp.com",
            projectId: "metro-new-85226",
            storageBucket: "metro-new-85226.firebasestorage.app",
            messagingSenderId: "905640751733",
            appId: "1:905640751733:web:f1ab3a1b119ca1e245fe3c"
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        let db;
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            console.log('‚úÖ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:', error);
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ —Ç–∏–∫–µ—Ç–∞
        function generateTicketId() {
            const now = new Date();
            const year = now.getFullYear();
            const month = (now.getMonth() + 1).toString().padStart(2, '0');
            const day = now.getDate().toString().padStart(2, '0');
            const randomNum = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return `MN-${year}${month}${day}-${randomNum}`;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showAlert(message, type) {
            const alert = document.getElementById('alert-message');
            alert.textContent = message;
            alert.className = 'alert';
            
            if (type === 'success') {
                alert.classList.add('alert-success');
            } else if (type === 'error') {
                alert.classList.add('alert-error');
            }
            
            alert.style.display = 'block';
            
            setTimeout(() => {
                alert.style.display = 'none';
            }, 5000);
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
        document.getElementById('feedbackForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –û—Ç–ø—Ä–∞–≤–∫–∞...';
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–∏–π
            if (!document.getElementById('privacy-policy').checked || 
                !document.getElementById('terms-of-service').checked) {
                showAlert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å —Å –ü–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ–º', 'error');
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ';
                return;
            }
            
            try {
                // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
                const formData = {
                    name: document.getElementById('name').value,
                    email: document.getElementById('email').value,
                    position: document.getElementById('position').value,
                    specialCode: document.getElementById('specialCode').value || '',
                    contactMethod: document.getElementById('contactMethod').value || '',
                    contactDetails: document.getElementById('contactDetails').value || '',
                    message: document.getElementById('message').value,
                    status: 'new',
                    createdAt: new Date().toISOString(),
                    assignedTo: null,
                    responses: []
                };
                
                const ticketId = generateTicketId();
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Firebase
                await db.collection('tickets').doc(ticketId).set(formData);
                
                // –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
                document.getElementById('feedbackForm').style.display = 'none';
                document.getElementById('ticketSuccess').style.display = 'block';
                document.getElementById('ticketNumber').textContent = ticketId;
                
                console.log('‚úÖ –¢–∏–∫–µ—Ç —Å–æ–∑–¥–∞–Ω:', ticketId);
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error);
                showAlert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ–±—Ä–∞—â–µ–Ω–∏—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.', 'error');
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ';
            }
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ç–∏–∫–µ—Ç–∞
        async function checkTicketStatus() {
            const ticketId = document.getElementById('checkTicketId').value.trim();
            const statusResult = document.getElementById('statusResult');
            
            if (!ticketId) {
                statusResult.innerHTML = '<p style="color: var(--danger);">‚ùå –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–∏–∫–µ—Ç–∞</p>';
                statusResult.classList.add('active');
                return;
            }
            
            statusResult.innerHTML = '<p>üîç –ü–æ–∏—Å–∫ —Ç–∏–∫–µ—Ç–∞...</p>';
            statusResult.classList.add('active');
            
            try {
                const ticketDoc = await db.collection('tickets').doc(ticketId).get();
                
                if (ticketDoc.exists) {
                    const ticket = ticketDoc.data();
                    const statusText = getStatusText(ticket.status);
                    const positionText = getPositionText(ticket.position);
                    
                    statusResult.innerHTML = `
                        <h3>üé´ –¢–∏–∫–µ—Ç: ${ticketId}</h3>
                        <div style="margin: 1rem 0;">
                            <p><strong>üë§ –ò–º—è:</strong> ${ticket.name}</p>
                            <p><strong>üíº –î–æ–ª–∂–Ω–æ—Å—Ç—å:</strong> ${positionText}</p>
                            <p><strong>üìß Email:</strong> ${ticket.email}</p>
                            <p><strong>üìÖ –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> ${new Date(ticket.createdAt).toLocaleString('ru-RU')}</p>
                            <p><strong>üìã –°—Ç–∞—Ç—É—Å:</strong> <span style="font-weight: bold;">${statusText}</span></p>
                            ${ticket.assignedTo ? `<p><strong>üë®‚Äçüíº –ù–∞–∑–Ω–∞—á–µ–Ω–æ:</strong> ${ticket.assignedTo}</p>` : ''}
                        </div>
                        <div style="background: #f8f9fa; padding: 1rem; border-radius: var(--radius-md);">
                            <strong>üí¨ –í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</strong>
                            <p style="margin: 0.5rem 0 0 0;">${ticket.message}</p>
                        </div>
                    `;
                } else {
                    statusResult.innerHTML = '<p style="color: var(--danger);">‚ùå –¢–∏–∫–µ—Ç —Å —Ç–∞–∫–∏–º –Ω–æ–º–µ—Ä–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω</p>';
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:', error);
                statusResult.innerHTML = '<p style="color: var(--danger);">‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç—É—Å–∞</p>';
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getStatusText(status) {
            const statusMap = {
                'new': 'üÜï –ù–æ–≤—ã–π',
                'in-progress': 'üõ†Ô∏è –í –æ–±—Ä–∞–±–æ—Ç–∫–µ', 
                'resolved': '‚úÖ –†–µ—à–µ–Ω',
                'closed': 'üîí –ó–∞–∫—Ä—ã—Ç'
            };
            return statusMap[status] || status;
        }

        function getPositionText(position) {
            const positionMap = {
                'player': 'üéÆ –ò–≥—Ä–æ–∫',
                'developer': 'üíª –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫',
                'moderator': 'üõ°Ô∏è –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä', 
                'admin': 'üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                'other': '‚ùì –î—Ä—É–≥–æ–µ'
            };
            return positionMap[position] || position;
        }

        // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –º–µ—Ç–æ–¥–∞
        document.getElementById('contactMethod').addEventListener('change', function() {
            const method = this.value;
            const detailsInput = document.getElementById('contactDetails');
            
            if (method === 'discord') {
                detailsInput.placeholder = 'username#1234';
            } else if (method === 'telegram') {
                detailsInput.placeholder = '@username';
            } else if (method === 'vk') {
                detailsInput.placeholder = 'id123456789 –∏–ª–∏ username';
            } else if (method === 'roblox') {
                detailsInput.placeholder = 'RobloxUsername';
            } else {
                detailsInput.placeholder = 'username#1234 –∏–ª–∏ @username';
            }
        });
    </script>
</body>
</html>
