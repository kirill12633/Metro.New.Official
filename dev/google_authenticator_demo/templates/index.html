<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Google Login Demo</title>
<script src="https://accounts.google.com/gsi/client" async defer></script>
<style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    img { max-width: 150px; border-radius: 50%; margin-top: 10px; }
</style>
</head>
<body>
<h2>Войдите через Google</h2>
<div class="g_id_signin"></div>
<div id="user-info" style="margin-top:20px;"></div>

<script>
const CLIENT_ID = "660870444962-d60ace1uae0u0g2t26e8qtq8240qu1qd.apps.googleusercontent.com";

function handleCredentialResponse(response) {
    // JWT ID Token
    const jwt = response.credential;

    // Декодируем payload из JWT
    const payload = JSON.parse(atob(jwt.split('.')[1]));

    // Исправляем кириллицу
    const name = decodeURIComponent(escape(payload.name));

    document.getElementById("user-info").innerHTML =
        `<p><strong>Имя:</strong> ${name}</p>
         <p><strong>Email:</strong> ${payload.email}</p>
         <img src="${payload.picture}" alt="User Picture">`;
}

window.onload = function() {
    google.accounts.id.initialize({
        client_id: CLIENT_ID,
        callback: handleCredentialResponse
    });
    google.accounts.id.renderButton(
        document.querySelector(".g_id_signin"),
        { theme: "outline", size: "large" }
    );
};
</script>
</body>
</html>
