<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –ú–µ—Ç—Ä–æ New</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">
    <style>
        .admin-auth {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 2rem;
        }

        .admin-panel {
            display: none;
            padding: 2rem 0;
        }

        .request-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border-left: 4px solid var(--warning);
            margin-bottom: 1rem;
        }

        .request-card.approved {
            border-left-color: var(--success);
        }

        .request-card.rejected {
            border-left-color: var(--danger);
        }

        .request-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .request-actions {
            display: flex;
            gap: 0.5rem;
        }

        .login-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: var(--radius-md);
            margin-bottom: 0.5rem;
        }

        .login-info {
            flex: 1;
        }

        .login-time {
            color: var(--gray);
            font-size: 0.8rem;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #dee2e6;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <!-- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞ -->
    <div class="admin-auth" id="adminAuth">
        <div class="card" style="max-width: 400px; text-align: center;">
            <h1><i class="fas fa-shield-alt"></i> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
            <p>–ú–µ—Ç—Ä–æ New - –°–∏—Å—Ç–µ–º–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</p>
            
            <form id="adminLoginForm">
                <div class="form-group">
                    <div class="input-with-icon">
                        <i class="fas fa-user input-icon"></i>
                        <input type="text" class="form-input" id="adminUsername" placeholder="–õ–æ–≥–∏–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="input-with-icon">
                        <i class="fas fa-lock input-icon"></i>
                        <input type="password" class="form-input" id="adminPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary w-100">
                    –í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                </button>
            </form>
            
            <div style="margin-top: 1rem; color: var(--gray); font-size: 0.8rem;">
                <i class="fas fa-lock"></i> –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞
            </div>
        </div>
    </div>

    <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
    <div class="admin-panel" id="adminPanel">
        <div class="container">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="card">
                <h1><i class="fas fa-cogs"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏ –º–æ–¥–µ—Ä–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤</p>
                
                <div class="admin-stats">
                    <div class="card text-center">
                        <span class="stat-number" id="totalRequests">0</span>
                        <span class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</span>
                    </div>
                    <div class="card text-center">
                        <span class="stat-number" id="pendingRequests">0</span>
                        <span class="stat-label">–û–∂–∏–¥–∞—é—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
                    </div>
                    <div class="card text-center">
                        <span class="stat-number" id="approvedRequests">0</span>
                        <span class="stat-label">–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ</span>
                    </div>
                    <div class="card text-center">
                        <span class="stat-number" id="rejectedRequests">0</span>
                        <span class="stat-label">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</span>
                    </div>
                </div>
            </div>

            <!-- –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é -->
            <div class="card mt-4">
                <div class="card-header">
                    <h2><i class="fas fa-user-check"></i> –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é</h2>
                    <button class="btn btn-secondary" onclick="refreshRequests()">
                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
                
                <div id="verificationRequests">
                    <!-- –ó–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>

            <!-- –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤ -->
            <div class="card mt-4">
                <div class="card-header">
                    <h2><i class="fas fa-history"></i> –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤—Ö–æ–¥—ã</h2>
                    <button class="btn btn-warning" onclick="clearLogs()">
                        <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
                    </button>
                </div>
                
                <div id="loginLogs">
                    <!-- –õ–æ–≥–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>

            <!-- –î–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
            <div class="card mt-4">
                <div class="card-header">
                    <h2><i class="fas fa-tools"></i> –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
                </div>
                
                <div class="grid grid-3">
                    <button class="btn btn-success" onclick="exportData()">
                        <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                    </button>
                    <button class="btn btn-info" onclick="showStats()">
                        <i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                    </button>
                    <button class="btn btn-danger" onclick="adminLogout()">
                        <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="../assets/js/main.js"></script>
    <script>
        // –î–∞–Ω–Ω—ã–µ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
        const ADMIN_CREDENTIALS = {
            username: 'admin',
            password: '123'
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ –∞–¥–º–∏–Ω
            const isAdminAuth = localStorage.getItem('admin_auth');
            if (isAdminAuth) {
                showAdminPanel();
            }
        });

        // –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞
        document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                localStorage.setItem('admin_auth', 'true');
                showAdminPanel();
                metroSystem.showNotification('–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å!', 'success');
            } else {
                metroSystem.showNotification('–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞!', 'error');
            }
        });

        function showAdminPanel() {
            document.getElementById('adminAuth').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
            loadAdminData();
        }

        function loadAdminData() {
            loadVerificationRequests();
            loadLoginLogs();
            updateStats();
        }

        function loadVerificationRequests() {
            const requestsContainer = document.getElementById('verificationRequests');
            
            // –ü–æ–ª—É—á–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã –∏–∑ localStorage
            const allUsers = getAllUsers();
            const verificationRequests = allUsers.filter(user => user.verificationPending && !user.verified);
            
            if (verificationRequests.length === 0) {
                requestsContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <h3>–ù–µ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é</h3>
                        <p>–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã</p>
                    </div>
                `;
                return;
            }
            
            requestsContainer.innerHTML = verificationRequests.map(user => `
                <div class="request-card" id="request-${user.verificationId}">
                    <div class="request-header">
                        <div>
                            <h3>${user.username}</h3>
                            <p style="color: var(--gray); font-size: 0.9rem;">${user.email}</p>
                        </div>
                        <div class="request-actions">
                            <button class="btn btn-success" onclick="approveVerification('${user.verificationId}')">
                                <i class="fas fa-check"></i> –û–¥–æ–±—Ä–∏—Ç—å
                            </button>
                            <button class="btn btn-danger" onclick="rejectVerification('${user.verificationId}')">
                                <i class="fas fa-times"></i> –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                            </button>
                        </div>
                    </div>
                    
                    <div class="user-info">
                        <p><strong>ID –∑–∞–ø—Ä–æ—Å–∞:</strong> ${user.verificationId}</p>
                        <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> ${user.joinDate}</p>
                        <p><strong>–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω:</strong> ${user.verificationRequestDate}</p>
                        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span style="color: var(--warning);">‚è≥ –û–∂–∏–¥–∞–µ—Ç</span></p>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                        <strong>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong>
                        <p>‚Ä¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–∂–∏–¥–∞–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∞</p>
                        <p>‚Ä¢ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö</p>
                    </div>
                </div>
            `).join('');
        }

        function loadLoginLogs() {
            const logsContainer = document.getElementById('loginLogs');
            const allUsers = getAllUsers();
            let allLogs = [];
            
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –ª–æ–≥–∏ –≤—Ö–æ–¥–æ–≤
            allUsers.forEach(user => {
                if (user.loginHistory) {
                    user.loginHistory.forEach(login => {
                        allLogs.push({
                            username: user.username,
                            time: login.time,
                            ip: login.ip,
                            device: login.device
                        });
                    });
                }
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
            allLogs.sort((a, b) => new Date(b.time) - new Date(a.time));
            
            if (allLogs.length === 0) {
                logsContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <h3>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –≤—Ö–æ–¥–∞—Ö</h3>
                        <p>–ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤ –ø—É—Å—Ç–∞</p>
                    </div>
                `;
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∑–∞–ø–∏—Å–µ–π
            const recentLogs = allLogs.slice(0, 20);
            
            logsContainer.innerHTML = recentLogs.map(log => `
                <div class="login-item">
                    <div class="login-info">
                        <strong>${log.username}</strong>
                        <div class="login-time">
                            ${log.time} ‚Ä¢ IP: ${log.ip} ‚Ä¢ ${log.device}
                        </div>
                    </div>
                    <div style="color: var(--success);">
                        <i class="fas fa-sign-in-alt"></i>
                    </div>
                </div>
            `).join('');
        }

        function getAllUsers() {
            const users = [];
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('metro_user_') || key === 'metro_user') {
                    try {
                        const userData = JSON.parse(localStorage.getItem(key));
                        users.push(userData);
                    } catch (e) {
                        console.error('Error parsing user data:', e);
                    }
                }
            }
            
            return users;
        }

        function updateStats() {
            const allUsers = getAllUsers();
            const verificationRequests = allUsers.filter(user => user.verificationPending && !user.verified);
            const approvedRequests = allUsers.filter(user => user.verified);
            const rejectedRequests = allUsers.filter(user => user.verificationRejected);
            
            document.getElementById('totalRequests').textContent = allUsers.length;
            document.getElementById('pendingRequests').textContent = verificationRequests.length;
            document.getElementById('approvedRequests').textContent = approvedRequests.length;
            document.getElementById('rejectedRequests').textContent = rejectedRequests.length;
        }

        // –î–µ–π—Å—Ç–≤–∏—è —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏
        function approveVerification(verificationId) {
            if (confirm('–û–¥–æ–±—Ä–∏—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                const allUsers = getAllUsers();
                const user = allUsers.find(u => u.verificationId === verificationId);
                
                if (user) {
                    user.verified = true;
                    user.verificationPending = false;
                    user.verificationDate = new Date().toLocaleString();
                    user.verifiedBy = 'admin';
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                    localStorage.setItem('metro_user_' + user.username, JSON.stringify(user));
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    document.getElementById('request-' + verificationId).classList.add('approved');
                    document.getElementById('request-' + verificationId).innerHTML = `
                        <div class="request-header">
                            <div>
                                <h3>${user.username}</h3>
                                <p style="color: var(--success);">‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ</p>
                            </div>
                        </div>
                        <div class="user-info">
                            <p><strong>–û–¥–æ–±—Ä–µ–Ω–æ:</strong> ${user.verificationDate}</p>
                            <p><strong>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:</strong> ${user.verifiedBy}</p>
                        </div>
                    `;
                    
                    updateStats();
                    metroSystem.showNotification('–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–¥–æ–±—Ä–µ–Ω–∞!', 'success');
                    
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Discord
                    sendAdminActionToDiscord('approve', user);
                }
            }
        }

        function rejectVerification(verificationId) {
            if (confirm('–û—Ç–∫–ª–æ–Ω–∏—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                const allUsers = getAllUsers();
                const user = allUsers.find(u => u.verificationId === verificationId);
                
                if (user) {
                    user.verified = false;
                    user.verificationPending = false;
                    user.verificationRejected = true;
                    user.rejectionDate = new Date().toLocaleString();
                    user.rejectedBy = 'admin';
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                    localStorage.setItem('metro_user_' + user.username, JSON.stringify(user));
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    document.getElementById('request-' + verificationId).classList.add('rejected');
                    document.getElementById('request-' + verificationId).innerHTML = `
                        <div class="request-header">
                            <div>
                                <h3>${user.username}</h3>
                                <p style="color: var(--danger);">‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ</p>
                            </div>
                        </div>
                        <div class="user-info">
                            <p><strong>–û—Ç–∫–ª–æ–Ω–µ–Ω–æ:</strong> ${user.rejectionDate}</p>
                            <p><strong>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:</strong> ${user.rejectedBy}</p>
                        </div>
                    `;
                    
                    updateStats();
                    metroSystem.showNotification('–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞!', 'success');
                    
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Discord
                    sendAdminActionToDiscord('reject', user);
                }
            }
        }

        async function sendAdminActionToDiscord(action, user) {
            const discordData = {
                embeds: [{
                    title: `üõ°Ô∏è –ê–î–ú–ò–ù –î–ï–ô–°–¢–í–ò–ï: ${action === 'approve' ? '–û–î–û–ë–†–ï–ù–û' : '–û–¢–ö–õ–û–ù–ï–ù–û'}`,
                    color: action === 'approve' ? 0x28A745 : 0xDC3545,
                    fields: [
                        {
                            name: "üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
                            value: user.username || "–ù–µ —É–∫–∞–∑–∞–Ω",
                            inline: true
                        },
                        {
                            name: "üìß Email",
                            value: user.email || "–ù–µ —É–∫–∞–∑–∞–Ω",
                            inline: true
                        },
                        {
                            name: "üÜî ID –∑–∞–ø—Ä–æ—Å–∞",
                            value: user.verificationId,
                            inline: true
                        },
                        {
                            name: "‚ö° –î–µ–π—Å—Ç–≤–∏–µ",
                            value: action === 'approve' ? '‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ' : '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ',
                            inline: true
                        },
                        {
                            name: "üë®‚Äçüíº –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä",
                            value: "admin",
                            inline: true
                        },
                        {
                            name: "üìÖ –í—Ä–µ–º—è",
                            value: new Date().toLocaleString(),
                            inline: true
                        }
                    ],
                    timestamp: new Date().toISOString(),
                    footer: {
                        text: "Metro New Admin System"
                    }
                }]
            };

            await metroSystem.sendToDiscord(discordData);
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function refreshRequests() {
            loadVerificationRequests();
            loadLoginLogs();
            updateStats();
            metroSystem.showNotification('–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!', 'success');
        }

        function clearLogs() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏ –≤—Ö–æ–¥–æ–≤?')) {
                const allUsers = getAllUsers();
                allUsers.forEach(user => {
                    if (user.loginHistory) {
                        user.loginHistory = [];
                        localStorage.setItem('metro_user_' + user.username, JSON.stringify(user));
                    }
                });
                loadLoginLogs();
                metroSystem.showNotification('–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã!', 'success');
            }
        }

        function exportData() {
            const allUsers = getAllUsers();
            const dataStr = JSON.stringify(allUsers, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `metro_new_admin_export_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            metroSystem.showNotification('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
        }

        function showStats() {
            const allUsers = getAllUsers();
            const stats = `
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã:

üë• –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${allUsers.length}
‚úÖ –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ: ${allUsers.filter(u => u.verified).length}
‚è≥ –û–∂–∏–¥–∞—é—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏: ${allUsers.filter(u => u.verificationPending).length}
‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ: ${allUsers.filter(u => u.verificationRejected).length}
üìä –ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π: ${allUsers.length}
            `.trim();
            
            alert(stats);
        }

        function adminLogout() {
            if (confirm('–í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏?')) {
                localStorage.removeItem('admin_auth');
                window.location.reload();
            }
        }
    </script>
</body>
</html>
